# v2.9.0 Release Notes - éº¦å…‹é£æ•è· + ASR è´¨é‡æå‡

**å‘å¸ƒæ—¥æœŸ**: 2025-10-17  
**ç‰ˆæœ¬**: v2.9.0  
**çŠ¶æ€**: âœ… ç¨³å®šç‰ˆ

---

## ğŸ“‹ æ¦‚è§ˆ

v2.9.0 å¼•å…¥äº†**éº¦å…‹é£æ•è· API**ï¼Œå¹¶**å¤§å¹…æå‡ ASR éŸ³é¢‘è´¨é‡**ï¼Œä½¿ `node-windows-audio-capture` æˆä¸º Windows å¹³å°æœ€å®Œæ•´çš„éŸ³é¢‘æ•è·è§£å†³æ–¹æ¡ˆã€‚

### ğŸ¯ æ ¸å¿ƒæ”¹è¿›

1. **ğŸ™ï¸ éº¦å…‹é£æ•è· API** - æ–°å¢ `MicrophoneCapture` ç±»
2. **ğŸ”Š ASR é‡é‡‡æ ·å‡çº§** - Linear â†’ Sinc æ’å€¼ï¼ˆæ˜¾è‘—æ”¹å–„éŸ³è´¨ï¼‰
3. **ğŸ“– å®Œæ•´æ–‡æ¡£** - æ–°å¢éº¦å…‹é£ API æ–‡æ¡£å’Œç¤ºä¾‹

---

## ğŸ™ï¸ æ–°ç‰¹æ€§ï¼šéº¦å…‹é£æ•è· API

### 1. MicrophoneCapture ç±»

**æ–°å¢é«˜çº§ API**ï¼Œç”¨äºéº¦å…‹é£éŸ³é¢‘æ•è·ï¼š

```javascript
const { MicrophoneCapture } = require('node-windows-audio-capture');

const mic = new MicrophoneCapture({
  deviceId: '{device-id}',  // å¯é€‰ï¼šé€‰æ‹©ç‰¹å®šéº¦å…‹é£
  denoise: true,             // RNNoise é™å™ª
  agc: true,                 // è‡ªåŠ¨å¢ç›Šæ§åˆ¶
  eq: true                   // 3-Band å‡è¡¡å™¨
});

mic.on('data', (buffer) => {
  // å¤„ç†éº¦å…‹é£éŸ³é¢‘æ•°æ®
});

await mic.start();
```

### 2. è®¾å¤‡é€‰æ‹©

**æ”¯æŒé€‰æ‹©ç‰¹å®šéº¦å…‹é£è®¾å¤‡**ï¼š

```javascript
const { listDevices } = require('node-windows-audio-capture');

// åˆ—å‡ºæ‰€æœ‰éŸ³é¢‘è®¾å¤‡
const devices = await listDevices();

// ç­›é€‰éº¦å…‹é£è®¾å¤‡ï¼ˆé Loopbackï¼‰
const microphones = devices.filter(d => !d.isLoopback);

console.log('å¯ç”¨éº¦å…‹é£:');
microphones.forEach(mic => {
  console.log(`  ${mic.name} (ID: ${mic.id})`);
});

// ä½¿ç”¨ç‰¹å®šéº¦å…‹é£
const mic = new MicrophoneCapture({
  deviceId: microphones[0].id
});
```

### 3. é›†æˆéŸ³é¢‘æ•ˆæœ

**ä¸ç³»ç»ŸéŸ³é¢‘æ•è·ç›¸åŒçš„éŸ³é¢‘æ•ˆæœ**ï¼š

- **RNNoise é™å™ª**: AI é™å™ªï¼Œæ¶ˆé™¤èƒŒæ™¯å™ªéŸ³
- **AGC (è‡ªåŠ¨å¢ç›Š)**: è‡ªåŠ¨è°ƒæ•´éŸ³é‡ï¼Œ< 5ms å»¶è¿Ÿ
- **3-Band EQ**: ä½/ä¸­/é«˜é¢‘å‡è¡¡å™¨ï¼ˆ-20~+20dBï¼‰

```javascript
const mic = new MicrophoneCapture({
  denoise: true,
  denoiseStrength: 0.8,  // 0-1, é»˜è®¤ 0.5
  
  agc: true,
  agcTarget: -16,        // dB, é»˜è®¤ -16dB
  
  eq: true,
  eqLowGain: -3,         // ä½é¢‘ -3dB
  eqMidGain: 5,          // ä¸­é¢‘ +5dB
  eqHighGain: 2          // é«˜é¢‘ +2dB
});
```

### 4. WASAPI ç›´æ¥æ•è·æ¨¡å¼

**åº•å±‚å®ç°**ï¼š
- ä½¿ç”¨ WASAPI ç›´æ¥æ•è·æ¨¡å¼ï¼ˆ`isLoopback = false`ï¼‰
- æ•è·éº¦å…‹é£ç‰©ç†è¾“å…¥ï¼Œè€Œéç³»ç»ŸéŸ³é¢‘ç¯å›
- ä¸ `AudioCapture` ç›¸åŒçš„åº•å±‚æ¶æ„ï¼Œè´¨é‡å¯é 

---

## ğŸ”Š æ”¹è¿›ï¼šASR é‡é‡‡æ ·è´¨é‡å‡çº§

### 1. Sinc æ’å€¼æ›¿ä»£çº¿æ€§æ’å€¼

**AudioProcessingPipeline é‡é‡‡æ ·å‡çº§**ï¼š

| ç‰ˆæœ¬ | é‡é‡‡æ ·ç®—æ³• | éŸ³è´¨ | é€‚ç”¨åœºæ™¯ |
|------|-----------|------|---------|
| v2.2 - v2.8 | Linearï¼ˆçº¿æ€§æ’å€¼ï¼‰ | â­â­â­ | ä¸€èˆ¬åœºæ™¯ |
| **v2.9** | **Sinc (Kaiser-windowed)** | â­â­â­â­â­ | **ASR/ç”Ÿäº§** âœ… |

**æ”¹è¿›æ•ˆæœ**ï¼š
- âœ… 48kHz â†’ 16kHz é™é‡‡æ ·æ—¶ï¼ŒéŸ³é¢‘å¤±çœŸæ˜¾è‘—å‡å°‘
- âœ… é¢‘åŸŸä¿æŒæ›´å¥½ï¼Œæ··å å¤±çœŸæœ€å°åŒ–
- âœ… æé«˜ ASR è¯†åˆ«å‡†ç¡®ç‡
- âœ… æ€§èƒ½å¼€é”€ < 0.2msï¼Œå‡ ä¹æ— å½±å“

### 2. è‡ªåŠ¨åº”ç”¨åˆ° ASR é¢„è®¾

**æ‰€æœ‰ ASR é¢„è®¾è‡ªåŠ¨å‡çº§**ï¼š

```javascript
const { AudioProcessingPipeline } = require('node-windows-audio-capture');

// ä»¥ä¸‹é¢„è®¾è‡ªåŠ¨ä½¿ç”¨ Sinc æ’å€¼ï¼ˆv2.9.0+ï¼‰
const pipeline1 = new AudioProcessingPipeline('china-asr');      // âœ… Sinc
const pipeline2 = new AudioProcessingPipeline('openai-whisper'); // âœ… Sinc
const pipeline3 = new AudioProcessingPipeline('azure');          // âœ… Sinc
const pipeline4 = new AudioProcessingPipeline('google');         // âœ… Sinc
```

**æ— éœ€ä»£ç æ›´æ”¹**ï¼Œè‡ªåŠ¨å—ç›Šï¼

### 3. æ‰‹åŠ¨é…ç½®æ”¯æŒ

**è‡ªå®šä¹‰é‡é‡‡æ ·è´¨é‡**ï¼š

```javascript
const pipeline = new AudioProcessingPipeline({
  targetSampleRate: 16000,
  targetChannels: 1,
  resamplingQuality: 'sinc'  // 'simple' | 'linear' | 'sinc'
});
```

**è´¨é‡å¯¹æ¯”**ï¼š

| Quality | Algorithm | Audio Quality | CPU | Latency |
|---------|-----------|---------------|-----|---------|
| `simple` | Direct sampling | â­ | æœ€ä½ | < 0.05ms |
| `linear` | Linear interpolation | â­â­â­ | ä½ | < 0.1ms |
| **`sinc`** | Kaiser-windowed Sinc | â­â­â­â­â­ | ä¸­ | < 0.2ms |

---

## ğŸ“– æ–°å¢æ–‡æ¡£

### 1. API æ–‡æ¡£æ›´æ–°

**`docs/api.md`** æ–°å¢ç« èŠ‚ï¼š
- `MicrophoneCapture` ç±»å®Œæ•´æ–‡æ¡£
- æ„é€ å‡½æ•°å‚æ•°è¯´æ˜
- äº‹ä»¶å’Œé”™è¯¯å¤„ç†
- å®Œæ•´ç¤ºä¾‹ä»£ç 

### 2. ç¤ºä¾‹ä»£ç 

**`examples/microphone-capture.js`** - å®Œæ•´éº¦å…‹é£æ•è·ç¤ºä¾‹ï¼š
- è®¾å¤‡åˆ—è¡¨å’Œé€‰æ‹©
- éŸ³é¢‘æ•ˆæœé…ç½®
- ASR æ ¼å¼è½¬æ¢
- é”™è¯¯å¤„ç†

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### 1. éº¦å…‹é£æ•è· + ASR

**å®Œæ•´çš„è¯­éŸ³è¯†åˆ«è§£å†³æ–¹æ¡ˆ**ï¼š

```javascript
const { MicrophoneCapture, AudioProcessingPipeline } = require('node-windows-audio-capture');

// å½•åˆ¶éº¦å…‹é£
const mic = new MicrophoneCapture({
  denoise: true,
  agc: true
});

// è½¬æ¢ä¸º ASR æ ¼å¼
const asrPipeline = new AudioProcessingPipeline('china-asr');  // è‡ªåŠ¨ Sinc æ’å€¼

mic.on('data', (buffer) => {
  // é«˜è´¨é‡ ASR éŸ³é¢‘
  const asrData = asrPipeline.process(buffer);
  sendToASR(asrData);  // å‘é€åˆ°ç™¾åº¦/è…¾è®¯/é˜¿é‡Œ ASR
});

await mic.start();
```

### 2. å®æ—¶ç¿»è¯‘è½¯ä»¶

**éº¦å…‹é£è¾“å…¥ + å®æ—¶è¯†åˆ«**ï¼š

```javascript
// å½•åˆ¶ç”¨æˆ·è¯­éŸ³
const mic = new MicrophoneCapture({
  denoise: true,
  agc: true,
  eq: true
});

// å¤„ç†éŸ³é¢‘æµ
const pipeline = new AudioProcessingPipeline('openai-whisper');

mic.on('data', async (buffer) => {
  const asrData = pipeline.process(buffer);
  const text = await whisperAPI.recognize(asrData);
  const translation = await translateAPI.translate(text);
  console.log('ç¿»è¯‘:', translation);
});
```

### 3. ä¼šè®®å½•éŸ³

**é«˜è´¨é‡å½•éŸ³ + é™å™ª**ï¼š

```javascript
const mic = new MicrophoneCapture({
  denoise: true,
  denoiseStrength: 0.8,
  agc: true,
  agcTarget: -16
});

const fs = require('fs');
const output = fs.createWriteStream('meeting-recording.pcm');

mic.pipe(output);
await mic.start();
```

---

## ğŸ”„ å‘åå…¼å®¹æ€§

### âœ… 100% å‘åå…¼å®¹

- **æ–° API**: `MicrophoneCapture` æ˜¯çº¯æ–°å¢åŠŸèƒ½
- **ç°æœ‰ä»£ç **: æ— éœ€ä»»ä½•æ›´æ”¹
- **ASR è´¨é‡**: è‡ªåŠ¨å‡çº§ï¼Œé€æ˜æ”¹è¿›
- **æ€§èƒ½**: å½±å“å¯å¿½ç•¥ï¼ˆ< 0.2msï¼‰

### è¿ç§»æŒ‡å—

**æ— éœ€è¿ç§»** - ç°æœ‰ä»£ç ç»§ç»­å·¥ä½œï¼ŒåŒæ—¶è‡ªåŠ¨å—ç›Šäº ASR è´¨é‡æå‡ï¼

å¦‚æœéœ€è¦ä½¿ç”¨æ–°çš„éº¦å…‹é£æ•è·åŠŸèƒ½ï¼š

```javascript
// ä¹‹å‰ï¼šç³»ç»ŸéŸ³é¢‘æ•è·
const { AudioCapture } = require('node-windows-audio-capture');
const capture = new AudioCapture({ processId: 0 });

// ç°åœ¨ï¼šéº¦å…‹é£æ•è·ï¼ˆæ–°å¢ï¼‰
const { MicrophoneCapture } = require('node-windows-audio-capture');
const mic = new MicrophoneCapture();  // ç›¸åŒçš„ API è®¾è®¡
```

---

## ğŸ“Š æ€§èƒ½å½±å“

### Sinc æ’å€¼æ€§èƒ½æµ‹è¯•

| æµ‹è¯•åœºæ™¯ | å¤„ç†æ—¶é—´ | éŸ³é¢‘æ—¶é•¿ | å®æ—¶ç‡ |
|---------|---------|---------|--------|
| 48kHz â†’ 16kHz | 111ms | 20s | **180x** âš¡ |
| Sinc åˆå§‹åŒ– | 4ms | - | ä¸€æ¬¡æ€§ |
| å¢é‡å»¶è¿Ÿ | < 0.2ms | æ¯å¸§ | å¯å¿½ç•¥ |

**ç»“è®º**: Sinc æ’å€¼å¸¦æ¥æ˜¾è‘—éŸ³è´¨æå‡ï¼Œæ€§èƒ½å¼€é”€å‡ ä¹ä¸ºé›¶ã€‚

---

## ğŸ› å·²çŸ¥é™åˆ¶

### 1. ç‰©ç†å½•éŸ³åœºæ™¯

**é™åˆ¶**ï¼šéº¦å…‹é£æ•è· + æ‰‹æœºæ‰¬å£°å™¨æ’­æ”¾ï¼ˆç©ºæ°”ä¼ æ’­ï¼‰
- éŸ³è´¨å—ç‰©ç†ç¯å¢ƒå½±å“ï¼ˆè·ç¦»ã€å™ªéŸ³ã€éº¦å…‹é£è´¨é‡ï¼‰
- è½¯ä»¶å±‚é¢å·²ä¼˜åŒ–åˆ°æé™ï¼ˆSinc + é™å™ª + AGCï¼‰

**å»ºè®®**ï¼š
- ä½¿ç”¨å¤–ç½® USB éº¦å…‹é£ï¼ˆæ›´é«˜çµæ•åº¦ï¼‰
- ä½¿ç”¨éŸ³é¢‘çº¿ç›´è¿ï¼ˆæ‰‹æœº 3.5mm â†’ ç”µè„‘çº¿è·¯è¾“å…¥ï¼‰
- å‡å°‘ç¯å¢ƒå™ªéŸ³ï¼Œé è¿‘éŸ³æº

### 2. è®¾å¤‡å…¼å®¹æ€§

**è¦æ±‚**ï¼š
- Windows 10/11
- éº¦å…‹é£è®¾å¤‡æ”¯æŒ WASAPI ç›´æ¥æ•è·æ¨¡å¼
- å¤§å¤šæ•°ç°ä»£éº¦å…‹é£å‡æ”¯æŒ

---

## ğŸš€ ä¸‹ä¸€æ­¥è®¡åˆ’

### v2.10.0ï¼ˆè§„åˆ’ä¸­ï¼‰

- **å¤šå£°é“éº¦å…‹é£**: æ”¯æŒ 5.1/7.1 å£°é“éº¦å…‹é£é˜µåˆ—
- **VAD å¢å¼º**: æ›´ç²¾ç¡®çš„è¯­éŸ³æ´»åŠ¨æ£€æµ‹
- **å®æ—¶ç»Ÿè®¡**: éº¦å…‹é£éŸ³é¢‘ç”µå¹³ç›‘æ§ API

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å®Œæ•´ API æ–‡æ¡£](api.md) - MicrophoneCapture è¯¦ç»†è¯´æ˜
- [å¿«é€Ÿå¼€å§‹æŒ‡å—](QUICK_START_GUIDE.md) - 30 ç§’ä¸Šæ‰‹
- [ç¿»è¯‘è½¯ä»¶é›†æˆ](TRANSLATION_SOFTWARE_INTEGRATION.md) - å®æ—¶ç¿»è¯‘å®Œæ•´æ–¹æ¡ˆ
- [ASR å…¼å®¹æ€§è·¯çº¿å›¾](ASR_COMPATIBILITY_ROADMAP.md) - ASR æ ¼å¼è¦æ±‚

---

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰ç”¨æˆ·çš„åé¦ˆå’Œå»ºè®®ï¼Œv2.9.0 çš„æ”¹è¿›ç›´æ¥æ¥æºäºç¤¾åŒºçš„å®é™…éœ€æ±‚ã€‚

ç‰¹åˆ«æ„Ÿè°¢ï¼š
- **RNNoise** - Xiph.org çš„å¼€æº AI é™å™ªåº“
- **WASAPI** - Microsoft çš„é«˜è´¨é‡éŸ³é¢‘ API
- **Kaiser-windowed Sinc** - ä¸šç•Œæœ€ä¼˜çš„é‡é‡‡æ ·ç®—æ³•

---

## ğŸ“¦ å®‰è£…

```bash
npm install node-windows-audio-capture@2.9.0
```

æˆ–ä»æºç æ„å»ºï¼š

```bash
git clone https://github.com/wujelly701/node-windows-audio-capture.git
cd node-windows-audio-capture
git checkout v2.9.0
npm install
npm run build
```

---

**å®Œæ•´æ›´æ–°æ—¥å¿—**: [CHANGELOG.md](../CHANGELOG.md)  
**GitHub Release**: [v2.9.0](https://github.com/wujelly701/node-windows-audio-capture/releases/tag/v2.9.0)
